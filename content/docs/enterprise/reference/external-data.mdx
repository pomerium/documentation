---
title: External Data Sources
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

By adding an external data source, Pomerium administrators can extend access policies by comparing data from an incoming request against any properly formatted data set. To explain how this works, let's look at the external datasets Pomerium provides.

## GeoIP Lookup

This dataset provides a list of IP address ranges and their country of origin, according to ARIN:

```json tittle="Example"
{"$index":{"cidr":"1.0.0.0/24"},"id":"1.0.0.0/24","country":"US","state":"","city":"","zip":"","timezone":""},
{"$index":{"cidr":"1.0.1.0/24"},"id":"1.0.1.0/24","country":"CN","state":"","city":"","zip":"","timezone":""},
```

An example policy to restrict access to IP addresses within the United States would look something like this:

<Tabs>
<TabItem value="builder" label="Builder">

![GeoIP Policy in the Builder view](./img/geoip-policy.png)

</TabItem>
<TabItem value="editor" label="Editor">

```yaml showLineNumbers
allow:
  and:
    - record:
        field: country
        is: US
        type: pomerium.io/IP2Location
```

</TabItem>
</Tabs>

This policy looks at the `country`

## Tor Exit Nodes

This dataset provides Tor exit node IP addresses.

```json tittle="Example"
  {"id": "101.3.121.242"},
  {"id": "102.130.113.9"},
```

A policy excluding exit nodes would look something like this:

<Tabs>
<TabItem value="builder" label="Builder">

![TorExitNode Policy in the Builder view](./img/tor-exit-node-policy.png)

</TabItem>
<TabItem value="editor" label="Editor">

```yaml showLineNumbers
deny:
  or:
    - record:
        contains: .
        field: id
        type: pomerium.io/TorExitNode
```

</TabItem>
</Tabs>

## VPN Providers

This dataset provides VPN node IP addresses.

```json title="Example"
[{ "id": "1.116.0.0/15" }, { "id": "1.12.32.0/23" }, { "id": "1.14.0.0/15" }]
```

A policy excluding VPN nodes would look something like this:

<Tabs>
<TabItem value="builder" label="Builder">

![VPNNode Policy in the Builder view](./img/vpn-node-policy.png)

</TabItem>
<TabItem value="editor" label="Editor">

```yaml showLineNumbers
deny:
  or:
    - record:
        contains: .
        field: id
        type: pomerium.io/VPNNode
```

</TabItem>
</Tabs>

## Well Known IP Range

This dataset provides Well Known IP address ranges.

```json title="Example"
[
  {
    "index": { "cidr": "1.0.0.0/24" },
    "id": "1.0.0.0/24",
    "as_number": "13335",
    "country_code": "US",
    "as_name": "CLOUDFLARENET"
  },
  {
    "index": { "cidr": "1.0.4.0/23" },
    "id": "1.0.4.0/23",
    "as_number": "38803",
    "country_code": "AU",
    "as_name": "WPL-AS-AP"
  },
  {
    "index": { "cidr": "1.0.6.0/23" },
    "id": "1.0.6.0/23",
    "as_number": "38803",
    "country_code": "AU",
    "as_name": "WPL-AS-AP"
  }
]
```

A policy requiring a well known IP address would look something like this:

<Tabs>
<TabItem value="builder" label="Builder">

![WellKnownIPRange Policy in the Builder view](./img/well-known-ip-range-policy.png)

</TabItem>
<TabItem value="editor" label="Editor">

```yaml showLineNumbers
deny:
  or:
    - record:
        is: "36459"
        field: as_number
        type: pomerium.io/WellKnownIPRange
```

</TabItem>
</Tabs>

## Custom datasets

The examples above are provided by Pomerium, but we encourage the community to build and share additional datasets, or integrate with internal datasets to extend their Pomerium policies.
